const { Document, Packer, Paragraph, TextRun, Table, TableCell, TableRow, WidthType, BorderStyle, VerticalAlign } = require("docx");
const fs = require("fs");

const warningShading = { fill: "FFF8DC" }; // Light amber/yellow

const doc = new Document({
  sections: [{
    properties: {},
    children: [
      // Title
      new Paragraph({
        text: "Allelio – Comprehensive Disclaimers and Legal Notice",
        heading: "Heading1",
        alignment: "center",
        spacing: { after: 100 },
        run: new TextRun({
          bold: true,
          size: 28,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Version 0.1.0 | February 2026",
        alignment: "center",
        spacing: { after: 400 },
        run: new TextRun({
          size: 20,
          italics: true,
          font: "Arial",
        }),
      }),

      // 1. Medical Disclaimer
      new Paragraph({
        text: "1. Medical Disclaimer",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Table({
        width: { size: 100, type: WidthType.PERCENTAGE },
        rows: [
          new TableRow({
            children: [
              new TableCell({
                children: [
                  new Paragraph({
                    text: "WARNING: Allelio is NOT a medical device, medical diagnostic tool, or medical advice. Analysis results are for educational purposes only and must not be used for clinical diagnosis, medical decision-making, or treatment planning. Always consult a qualified healthcare provider before making any health decisions based on genetic information.",
                    run: new TextRun({
                      bold: true,
                      size: 22,
                      font: "Arial",
                    }),
                  }),
                ],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
        ],
      }),
      new Paragraph({ text: "", spacing: { after: 200 } }),

      // 2. Genetic Information Limitations
      new Paragraph({
        text: "2. Genetic Information Limitations",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Genetic variation alone does not determine health outcomes. Many conditions are multifactorial (influenced by genetics, environment, lifestyle, and luck).",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Genotyping errors may occur in your raw DNA file due to sequencing technology limitations.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Population bias: Databases like ClinVar and GWAS Catalog are skewed toward European ancestry; findings may not apply equally to other populations.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Database limitations: ClinVar and GWAS Catalog are constantly evolving; absent data does not mean absence of risk.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 3. AI-Generated Content Disclaimer
      new Paragraph({
        text: "3. AI-Generated Content Disclaimer",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Table({
        width: { size: 100, type: WidthType.PERCENTAGE },
        rows: [
          new TableRow({
            children: [
              new TableCell({
                children: [
                  new Paragraph({
                    text: "CAUTION: Explanations are generated by a local LLM (Ollama). Large Language Models can hallucinate, produce plausible-sounding but inaccurate content, and may misinterpret genetic data. AI-generated explanations have not been medically reviewed or peer-vetted. Do not rely solely on AI explanations for health decisions.",
                    run: new TextRun({
                      bold: true,
                      size: 22,
                      font: "Arial",
                    }),
                  }),
                ],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
        ],
      }),
      new Paragraph({ text: "", spacing: { after: 200 } }),

      // 4. Psychological and Emotional Impact
      new Paragraph({
        text: "4. Psychological and Emotional Impact",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Genetic analysis findings, particularly related to serious diseases or untreatable conditions, may cause significant psychological distress.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Specific warning: APOE4 variants are associated with increased Alzheimer's disease risk, which can be emotionally difficult to process. Genetic counseling is strongly recommended if you carry these variants.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "We recommend consulting a genetic counselor to discuss results in context.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 5. Privacy and Data Handling
      new Paragraph({
        text: "5. Privacy and Data Handling",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Allelio processes all data locally on your computer. Your raw DNA file and analysis results never leave your machine.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "During initial setup, Allelio downloads ClinVar and GWAS databases from public internet sources. These downloads are necessary for functionality.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You are responsible for securing your raw DNA file and analysis results. Store them in a protected location on your computer.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 6. Special Warnings for High-Impact Variants
      new Paragraph({
        text: "6. Special Warnings for High-Impact Variants",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "The following variants warrant special attention and professional genetic counseling:",
        spacing: { after: 100 },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Table({
        width: { size: 100, type: WidthType.PERCENTAGE },
        rows: [
          new TableRow({
            children: [
              new TableCell({
                children: [new Paragraph({ text: "Gene", bold: true, run: new TextRun({ bold: true, font: "Arial" }) })],
                shading: { fill: "D3D3D3" },
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Significance", bold: true, run: new TextRun({ bold: true, font: "Arial" }) })],
                shading: { fill: "D3D3D3" },
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Recommendation", bold: true, run: new TextRun({ bold: true, font: "Arial" }) })],
                shading: { fill: "D3D3D3" },
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
          new TableRow({
            children: [
              new TableCell({
                children: [new Paragraph({ text: "BRCA1/BRCA2", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "High cancer risk (breast, ovarian, prostate)", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Genetic counselor; consider clinical testing", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
          new TableRow({
            children: [
              new TableCell({
                children: [new Paragraph({ text: "APOE4", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Increased Alzheimer's disease risk", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Genetic counselor; neurologist if symptomatic", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
          new TableRow({
            children: [
              new TableCell({
                children: [new Paragraph({ text: "TP53", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Li-Fraumeni Syndrome; multiple cancer risk", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Immediate genetic counselor referral required", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
          new TableRow({
            children: [
              new TableCell({
                children: [new Paragraph({ text: "MLH1/MSH2/MSH6/PMS2", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Lynch Syndrome; colorectal/endometrial cancer risk", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
              new TableCell({
                children: [new Paragraph({ text: "Genetic counselor; oncologist if positive", run: new TextRun({ font: "Arial" }) })],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
        ],
      }),
      new Paragraph({ text: "", spacing: { after: 200 } }),

      // 7. Software Disclaimer and Limitation of Liability
      new Paragraph({
        text: "7. Software Disclaimer and Limitation of Liability",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Allelio is provided \"as is\" without warranty of any kind, express or implied.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "The authors and contributors are not liable for any damages, including but not limited to: loss of data, business interruption, or health-related harm resulting from the use of Allelio.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Use of Allelio is at your own risk.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 8. Third-Party Data Sources
      new Paragraph({
        text: "8. Third-Party Data Sources",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "ClinVar – Maintained by NCBI (National Center for Biotechnology Information). Allelio uses ClinVar data under their terms of use.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "GWAS Catalog – Maintained by EBI (European Bioinformatics Institute). Allelio uses GWAS data under their licensing terms.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Ollama – Local AI inference engine. Allelio is not affiliated with or endorsed by Ollama.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "23andMe & AncestryDNA – Allelio is not affiliated with these companies and does not endorse their services.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 9. Research Use and Regulatory Status
      new Paragraph({
        text: "9. Research Use and Regulatory Status",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Allelio is not FDA-approved and is not intended for clinical use.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Allelio has not been verified or certified under CLIA (Clinical Laboratory Improvement Amendments) or CAP (College of American Pathologists) standards.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Use for research purposes is permitted under open-source licensing terms.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 10. User Responsibilities
      new Paragraph({
        text: "10. User Responsibilities",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "By using Allelio, you commit to the following responsibilities:",
        spacing: { after: 100 },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You understand Allelio is not a medical device and will not use it as a substitute for professional medical advice.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You will not self-diagnose or self-treat based solely on Allelio results.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You will consult qualified healthcare providers for any health concerns.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You accept full responsibility for any health decisions made in relation to Allelio results.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You are responsible for securing your raw DNA file and keeping it confidential.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You understand that AI-generated explanations may contain errors and require critical evaluation.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You will not use Allelio to discriminate against others or make decisions affecting others' lives based on genetic data.",
        spacing: { after: 50 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "You will not analyze anyone else's DNA data without their explicit, informed consent.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 11. Genetic Discrimination
      new Paragraph({
        text: "11. Genetic Discrimination",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "In the United States, the Genetic Information Nondiscrimination Act (GINA) prohibits discrimination based on genetic information in health insurance and employment.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Important limitations: GINA does not cover life insurance, disability insurance, long-term care insurance, military employment, or employers with fewer than 15 employees.",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Protections vary by country. Consult local legal resources for protections in your jurisdiction.",
        spacing: { after: 200 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 12. Use by Children and Minors
      new Paragraph({
        text: "12. Use by Children and Minors",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Table({
        width: { size: 100, type: WidthType.PERCENTAGE },
        rows: [
          new TableRow({
            children: [
              new TableCell({
                children: [
                  new Paragraph({
                    text: "WARNING: Allelio is not intended for use by individuals under 18 years old without parental consent and supervision. Genetic testing in minors raises ethical concerns about autonomy, consent, and psychological impact. If a minor's genetic information is analyzed, parental involvement, informed consent, and genetic counseling are essential.",
                    run: new TextRun({
                      bold: true,
                      size: 22,
                      font: "Arial",
                    }),
                  }),
                ],
                shading: warningShading,
                verticalAlign: VerticalAlign.CENTER,
              }),
            ],
          }),
        ],
      }),
      new Paragraph({ text: "", spacing: { after: 200 } }),

      // 13. Changes to These Disclaimers
      new Paragraph({
        text: "13. Changes to These Disclaimers",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Allelio disclaimers and terms may be updated periodically as the software evolves, databases are updated, or legal requirements change. Users are responsible for reviewing updates. Continued use of Allelio after updates constitutes acceptance of revised terms.",
        spacing: { after: 200 },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // 14. Where to Find Help
      new Paragraph({
        text: "14. Where to Find Help",
        heading: "Heading2",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          bold: true,
          size: 24,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "Genetic Counselor Finder – National Society of Genetic Counselors (NSGC): www.nsgc.org",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "ClinVar Documentation – www.ncbi.nlm.nih.gov/clinvar",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "GWAS Catalog – www.ebi.ac.uk/gwas",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "National Human Genome Research Institute (NHGRI) – www.genome.gov",
        spacing: { after: 100 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),
      new Paragraph({
        text: "MedlinePlus Genetics – medlineplus.gov/genetics",
        spacing: { after: 400 },
        numbering: {
          level: 0,
          reference: "bullet1",
        },
        run: new TextRun({
          size: 22,
          font: "Arial",
        }),
      }),

      // Footer
      new Paragraph({
        text: "Acknowledging these disclaimers is essential for responsible use of Allelio. Thank you for prioritizing your health and the privacy of genetic information.",
        alignment: "center",
        spacing: { before: 200, after: 100 },
        run: new TextRun({
          italics: true,
          size: 20,
          font: "Arial",
          color: "666666",
        }),
      }),
      new Paragraph({
        text: "Allelio – A gift to humanity",
        alignment: "center",
        spacing: { after: 100 },
        run: new TextRun({
          italics: true,
          size: 20,
          font: "Arial",
          color: "666666",
        }),
      }),
    ],
  }],
});

Packer.toBuffer(doc).then(buffer => {
  fs.writeFileSync("/sessions/dreamy-busy-albattani/mnt/Claude/allelio/docs/Allelio_Disclaimers.docx", buffer);
  console.log("Allelio_Disclaimers.docx created successfully");
});
